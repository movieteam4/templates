{% load static %}
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>Team 4</title>
    <!-- Bootstrap core CSS -->
    <link href="https://cdn.jsdelivr.net/gh/movieteam4/style@refs/heads/main/bootstrap.min.css" rel="stylesheet">

    <!-- Additional CSS Files -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/movieteam4/style@refs/heads/main/templatemo-lugx-gaming.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/movieteam4/style@refs/heads/main/owl.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/movieteam4/style@refs/heads/main/animate.css">
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
    <!-- TemplateMo 589 lugx gaming -->
    {% if detail %}
  <script type="text/javascript">
      alert("{{detail}}");
  </script>
{% endif %}
<style>
  .heart-checkbox input[type="checkbox"] {
    display: none;  /* 隱藏默認的checkbox */
  }

  .heart-checkbox label {
    position: relative;
    font-size: 25px;
    cursor: pointer;
    color: #ff4081;  /* 愛心顏色 */
  }

  .heart-checkbox label i.fas.fa-heart {
    display: none;  /* 初始狀態，隱藏實心愛心 */
  }

  .heart-checkbox input[type="checkbox"]:checked + label i.fas.fa-heart {
    display: inline;  /* 勾選後顯示實心愛心 */
  }

  .heart-checkbox input[type="checkbox"]:checked + label i.far.fa-heart {
    display: none;  /* 勾選後隱藏空心愛心 */
  }
</style>
</head>
  <body>
    <!-- ***** Preloader Start ***** -->
    <div id="js-preloader" class="js-preloader">
      <div class="preloader-inner">
        <span class="dot"></span>
        <div class="dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
    <script>
      window.onload = function () {
        const preloader = document.getElementById('js-preloader');
        if (preloader) {
          preloader.style.display = 'none'; // Hide the preloader
        }
      }
    </script>
    <!-- ***** Preloader End ***** -->

    <!-- ***** Header Area Start ***** -->
    <header class="header-area header-sticky">
      <div class="container">
          <div class="row">
              <div class="col-12">
                  <nav class="main-nav">
                      <!-- ***** Logo Start ***** -->
                      <a href="{% url 'Taiwan_movies_all' %}" class="logo">
                          <img src="https://raw.githubusercontent.com/movieteam4/img/refs/heads/main/logo.png" alt="" style="width: 158px;">
                      </a>
                      <!-- ***** Logo End ***** -->
                      <!-- ***** Menu Start ***** -->
                      <ul class="nav">
                        {% comment %} <li>
                          <div class="search-input">
                            <form id="search" action="{% url 'search' %}">
                              <input type="text" placeholder="搜尋電影" id="searchText" name="searchKeyword" />
                              <button role="button" style="background-color: white; color: black;">
                                <i class="fas fa-search" style="font-size: 20px;"></i>
                              </button>
                            </form>
                          </div>
                        </li> {% endcomment %}
                        {{status|safe}}
                      </ul>
                        <a class='menu-trigger'>
                          <span>Menu</span>
                      </a>
                  </nav>
              </div>
          </div>
      </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <div class="main-banner">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 align-self-center">
            <div class="caption header-text">
              <h5>Welcome to Team 4</h5>
              <h2>本周銷售第一:<br>{{number_1_name}}</h2>
              <h6>{{number_1_name_eng}}</h6>
              <p>{{description}}<a href="/Taiwan_movies_all/more_detail/?m={{number_1_name}}" style="color:black">more</a></p>
            </div>
          </div>
          <div class="col-lg-4 offset-lg-2">
            <div class="right-image">
              <a href="https://taiwan-movies-36c4c3ac2ec6.herokuapp.com/Taiwan_movies_all/more_detail/?m={{number_1_name}}"> <img src="{{number_1}}" alt=""></a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="features">
      <div class="container">
        <div class="row">
          <div class="col-lg-3 col-md-6">
            <a href="{% url 'Line' %}">
              <div class="item">
                <div class="image">
                  <img src="https://raw.githubusercontent.com/movieteam4/img/refs/heads/main/Line.png" alt="" style="max-width: 44px;">
                </div>
                <h4>我們的Line</h4>
              </div>
            </a>
          </div>
          <div class="col-lg-3 col-md-6">
            <a href="{% url 'user_more' %}">
              <div class="item">
                <div class="image">
                  <img src="https://raw.githubusercontent.com/movieteam4/img/refs/heads/main/featured-02.png" alt="" style="max-width: 44px;">
                </div>
                <h4>個人資料</h4>
              </div>
            </a>
          </div>
          <div class="col-lg-3 col-md-6">
            <a href="{% url 'favorite_page' %}">
              <div class="item">
                <div class="image">
                  <i class="fas fa-heart" style="font-size: 44px; color: white; margin-top:25px"></i>
                </div>
                <h4>收藏</h4>
              </div>
            </a>
          </div>
          <div class="col-lg-3 col-md-6">
            <a href="{% url 'forum' %}">
              <div class="item">
                <div class="image">
                  <img src="https://raw.githubusercontent.com/movieteam4/img/refs/heads/main/featured-04.png" alt="" style="max-width: 44px;">
                </div>
                <h4>論壇</h4>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="section trending">
      <div class="container">
        <div class="row">
          <div class="col-lg-6">
            <div class="section-heading">
              <h6>Trending</h6>
              <h2>Trending Movies</h2>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="main-button">
              <a href="shop">熱映中的電影</a>
            </div>
          </div>
          {{res|safe}}
        </div>
      </div>
    </div>

    <footer>
      <div class="container">
        <div class="col-lg-12">
          <p>宏碁專班-第4組-學術作品-無商業用途 &nbsp;&nbsp; <a rel="nofollow" href="https://templatemo.com" target="_blank">Design: TemplateMo</a></p>
        </div>
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/gh/movieteam4/js@refs/heads/main/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/movieteam4/js@refs/heads/main/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/movieteam4/js@refs/heads/main/isotope.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/movieteam4/js@refs/heads/main/owl-carousel.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/movieteam4/js@refs/heads/main/counter.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/movieteam4/js@refs/heads/main/custom.js"></script>
    <script type="text/javascript">
      // 將 CSRF 令牌存儲在 JavaScript 變量中
      const csrftoken = '{{ csrf_token }}';
    </script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>
    $(document).ready(function() {
      // 監聽每個 checkbox 的變化

      $('input[type="checkbox"]').on('change', function() {
        var checkboxId = $(this).attr('id');        // 取得勾選框的 id
        var isChecked = $(this).prop('checked');    // 判斷是否勾選
        var movieTitle = $(this).data('movie-title'); // 取得電影的中文名稱

        // 發送 AJAX 請求
        $.ajax({
          url: "{% url 'handle' %}",  // 替換成後端的 URL
          method: 'POST',  // 使用 POST 方法
          data: {
            'id': checkboxId,        // 傳送 checkbox 的 ID
            'liked': isChecked,      // 傳送勾選狀態 (true 或 false)
            'movie_title': movieTitle,
            'csrfmiddlewaretoken': csrftoken // 傳送電影名稱
          },
          success: function(response) {
            // 可以在這裡處理成功回調
            console.log('Data saved successfully:', response);
          },
          error: function(error) {
            // 可以在這裡處理錯誤回調
            console.error('Error saving data:', error);
          }
        });
      });
    });
  </script>